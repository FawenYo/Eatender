{"version":3,"sources":["components/Schedular.js","index.js"],"names":["pull_id","Wrapper","styled","div","ScheduleWrapper","H1","h1","header","subHeader","startYear","startMonth","startDate","num_days","min_time","max_time","lastSelect","window","onload","query_url","location","href","url","URL","searchParams","get","user_id","$","ajax","contentType","method","data","dataType","success","status","console","log","fetchedData","last_select","dateString","start_date","split","vote_name","vote_end","Swal","fire","icon","title","text","error_message","confirmButtonText","error","Schedular","passScheduleOut","useState","schedule","setSchedule","selection","Date","numDays","minTime","maxTime","hourlyChunks","onChange","newSchedule","timeFormat","document","ready","ReactDOM","render","StrictMode","length","sendData","dates","JSON","stringify","type","result","init","getElementById"],"mappings":"uHAkCIA,E,yEAdEC,EAAUC,UAAOC,IAAV,kFAKPC,EAAkBF,UAAOC,IAAV,iJAMfE,EAAKH,UAAOI,GAAV,6CAIJC,EAAS,0BACTC,EAAY,mEACXC,EAAmE,KAAxDC,EAA8D,EAAlDC,EAAqD,EAA1CC,EAA6C,EAAnCC,EAAsC,EAA5BC,EAA+B,GACtFC,EAAa,GAEjBC,OAAOC,OAAS,WACd,IAAIC,EAAYF,OAAOG,SAASC,KAC5BC,EAAM,IAAIC,IAAIJ,GAClBlB,EAAUqB,EAAIE,aAAaC,IAAI,MAC/BC,QAAUJ,EAAIE,aAAaC,IAAI,QAK/BE,EAAEC,KAAK,CACLN,IAAK,wCACLO,YAAa,mBACbC,OAAQ,MACRC,KAAM,CACJ9B,QAASA,EACTyB,QAASA,SAEXM,SAAU,OACVC,QAAS,SAAUF,GACjB,GAAmB,WAAfA,EAAKG,OAAqB,CAE5BC,QAAQC,IAAI,2BACZ,IAAIC,EAAcN,EAAKA,KACvBf,EAAaqB,EAAYC,YACzB,IAAIC,EAAaF,EAAYG,WAAWC,MAAM,KAE9CjC,EAAS6B,EAAYK,UACrBjC,EAAS,oDAAa4B,EAAYM,UAClCjC,EAAY6B,EAAW,GACvB5B,EAAa4B,EAAW,GACxB3B,EAAY2B,EAAW,GACvB1B,EAAWwB,EAAYxB,SACvBC,EAAWuB,EAAYvB,SACvBC,EAAWsB,EAAYtB,cAGvB6B,KAAKC,KAAK,CACRC,KAAM,QACNC,MAAO,2BACPC,KAAMjB,EAAKkB,cACXC,kBAAmB,kBAIzBC,MAAO,WACLhB,QAAQC,IAAI,gBAmCHgB,ICpHXnD,EAASyB,EDoHE0B,EA9Bf,YAAyC,IAApBC,EAAmB,EAAnBA,gBAAmB,EACNC,mBAAStC,GADH,mBAC/BuC,EAD+B,KACrBC,EADqB,KAOtC,OACE,kBAACtD,EAAD,KACE,gCACE,kBAACI,EAAD,KAAKE,GACL,2BAAIC,IAEN,6BACA,kBAACJ,EAAD,KACE,kBAAC,IAAD,CACEoD,UAAWF,EACX3C,UAAW,IAAI8C,KAAKhD,EAAWC,EAAa,EAAGC,GAC/C+C,QAAS9C,EACT+C,QAAS9C,EACT+C,QAAS9C,EACT+C,aAAc,EACdC,SAnBR,SAAsBC,GACpBR,EAAYQ,GACZX,EAAgBW,IAkBVC,WAAY,cC3GtBtC,EAAEuC,UAAUC,OAAM,WAChB,IAAIhD,EAAYF,OAAOG,SAASC,KAC5BC,EAAM,IAAIC,IAAIJ,GAElBlB,EAAUqB,EAAIE,aAAaC,IAAI,MAC/BC,EAAUJ,EAAIE,aAAaC,IAAI,WAoCjC2C,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,CACEjB,gBAnCN,SAAsBE,GACpB,GAAuB,GAAnBA,EAASgB,OAAa,CACxB,IAAIC,EAAW,CACbvE,UACAyB,UACA+C,MAAOlB,GAET5B,EAAEC,KAAK,CACLN,IAAI,yCACJO,YAAa,mBACbC,OAAQ,OACRE,SAAU,OACVD,KAAM2C,KAAKC,UAAUH,GACrBvC,QAAS,SAAUF,GACE,WAAfA,EAAKG,OACPC,QAAQC,IAAI,kBAAmBoC,GAE/B5B,KAAKC,KAAK,CACR+B,KAAM,QACN7B,MAAO,2BACPC,KAAMjB,EAAK8C,OACX3B,kBAAmB,kBAIzBC,MAAO,WACL2B,eAYNZ,SAASa,eAAe,gB","file":"static/js/main.f5f79092.chunk.js","sourcesContent":["import ScheduleSelector from 'react-schedule-selector';\nimport styled from 'styled-components';\nimport React, { useState } from 'react';\n\n\n// 在要使用 schedular 的 js 檔中直接插入元件，並加入一個取得 schedule 的 callback。舉例如下： \n// \n//  <Schedular\n//    passScheduleOut = {getSchedule}\n//  ></Schedular>\n// \n// passScheduleOut 會在使用者每次更改選擇時間後呼叫。\n// 其需要在使用到 Schedular 的 js 檔中自行定義。\n//\n// 簡單的 passScheduleOut 範例：\n// \n//  function passScheduleOut(schedule){ \n//    console.log(schedule); \n//  }\n//\nconst Wrapper = styled.div`\n  text-align: center;\n  margin: 0 auto;\n  width: 80%`;\n\nconst ScheduleWrapper = styled.div`\n  padding: 20px;\n  border-radius: 20px;\n  background: white;\n  box-shadow: 3px 5px 18px 0px rgba(191,191,191,0.76)`;\n\nconst H1 = styled.h1`\n  font-size: 32pt`;\n\nlet pull_id;\nlet header = \"React Schedule Selector\";\nlet subHeader = \"Tap to select one time or drag to select multiple times at once.\";\nlet [startYear, startMonth, startDate, num_days, min_time, max_time] = [2021, 3, 8, 4, 4, 14];\nlet lastSelect = [];\n\nwindow.onload = () => {\n  let query_url = window.location.href\n  let url = new URL(query_url);\n  pull_id = url.searchParams.get(\"id\");\n  user_id = url.searchParams.get(\"name\");\n  fetchScheduleParams();\n}\n\nfunction fetchScheduleParams() {\n  $.ajax({\n    url: \"http://0.0.0.0:8001/api/vote/get/date\",\n    contentType: \"application/json\",\n    method: \"GET\",\n    data: {\n      pull_id: pull_id,\n      user_id: user_id\n    },\n    dataType: \"json\",\n    success: function (data) {\n      if (data.status == \"success\") {\n        // RETURN\n        console.log(\"RETURN SCHEDULAR PARAMS\")\n        let fetchedData = data.data;\n        lastSelect = fetchedData.last_select;\n        let dateString = fetchedData.start_date.split('/');\n\n        header = fetchedData.vote_name;\n        subHeader = `投票截止日期：${fetchedData.vote_end}`;\n        startYear = dateString[0];\n        startMonth = dateString[1];\n        startDate = dateString[2];\n        num_days = fetchedData.num_days;\n        min_time = fetchedData.min_time;\n        max_time = fetchedData.max_time;\n\n      } else {\n        Swal.fire({\n          icon: \"error\",\n          title: \"很抱歉！\",\n          text: data.error_message,\n          confirmButtonText: \"確認\",\n        })\n      }\n    },\n    error: function () {\n      console.log(\"error dd\")\n    },\n  })\n}\n\nfunction Schedular({ passScheduleOut }) {\n  const [schedule, setSchedule] = useState(lastSelect);\n\n  function handleChange(newSchedule) {\n    setSchedule(newSchedule);\n    passScheduleOut(newSchedule);\n  }\n  return (\n    <Wrapper>\n      <header>\n        <H1>{header}</H1>\n        <p>{subHeader}</p>\n      </header>\n      <br />\n      <ScheduleWrapper>\n        <ScheduleSelector\n          selection={schedule}\n          startDate={new Date(startYear, startMonth - 1, startDate)}\n          numDays={num_days}\n          minTime={min_time}\n          maxTime={max_time}\n          hourlyChunks={1}\n          onChange={handleChange}\n          timeFormat={\"hh:mma\"}\n        />\n      </ScheduleWrapper>\n    </Wrapper>\n  )\n}\n\nexport default Schedular;","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Schedular from './components/Schedular'\n\nlet pull_id, user_id;\n\n$(document).ready(function () {\n  var query_url = window.location.href\n  var url = new URL(query_url);\n\n  pull_id = url.searchParams.get(\"id\")\n  user_id = url.searchParams.get(\"name\")\n})\n\n\nfunction postSchedule(schedule) {\n  if (schedule.length != 0) {\n    let sendData = {\n      pull_id,\n      user_id,\n      dates: schedule\n    }\n    $.ajax({\n      url: `http://0.0.0.0:8001/api/vote/save/date`,\n      contentType: \"application/json\",\n      method: \"POST\",\n      dataType: \"json\",\n      data: JSON.stringify(sendData),\n      success: function (data) {\n        if (data.status == \"success\") {\n          console.log('uploaded data: ', sendData)\n        } else {\n          Swal.fire({\n            type: \"error\",\n            title: \"很抱歉！\",\n            text: data.result,\n            confirmButtonText: \"確認\",\n          })\n        }\n      },\n      error: function () {\n        init()\n      },\n    })\n  }\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <Schedular\n      passScheduleOut={postSchedule}\n    />\n  </React.StrictMode>,\n  document.getElementById('schedular')\n)\n"],"sourceRoot":""}